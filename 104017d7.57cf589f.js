(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{63:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return i})),n.d(t,"default",(function(){return u}));var r=n(3),o=n(7),a=(n(0),n(95)),c={id:"access",title:"Access"},s={unversionedId:"tutorial/access",id:"tutorial/access",isDocsHomePage:!1,title:"Access",description:"Open up Aft and navigate to the Access section.",source:"@site/docs/tutorial/09-access.md",slug:"/tutorial/access",permalink:"/docs/tutorial/access",version:"current",sidebar:"main",previous:{title:"Updating",permalink:"/docs/tutorial/updates"},next:{title:"Review",permalink:"/docs/tutorial/review"}},i=[{value:"Roles",id:"roles",children:[]}],l={toc:i};function u(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Open up Aft and navigate to the ",Object(a.b)("strong",{parentName:"p"},"Access")," section."),Object(a.b)("p",null,"Click on the role labeled ",Object(a.b)("strong",{parentName:"p"},"User"),"."),Object(a.b)("p",null,"This is the default role for a signed in user, though of course you can change that to suit your application's needs. Starting out, the User role is granted access to some of the login methods, the API methods, and to read and update their own user object."),Object(a.b)("p",null,"You should see an ",Object(a.b)("strong",{parentName:"p"},"Add")," button under Models. Click that, and select ",Object(a.b)("inlineCode",{parentName:"p"},"Todo")," from the dropdown."),Object(a.b)("p",null,"This grants access to all Todos to the user role, which is too broad."),Object(a.b)("p",null,"Click ",Object(a.b)("strong",{parentName:"p"},"Detail")," to expand the policy editor. You should see three sections, labeled Read Create and Update."),Object(a.b)("p",null,"Under each, add the following policy."),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),'{\n    "user": {"id": "$USER_ID"}\n}\n')),Object(a.b)("p",null,"This indicates that a user can create, read or update only their own Todos."),Object(a.b)("p",null,"Hit ",Object(a.b)("strong",{parentName:"p"},"Save")," to update the permissions for this role."),Object(a.b)("h2",{id:"roles"},"Roles"),Object(a.b)("p",null,"Let's connect our test user with the role we just created. Ordinarily this connection would be done by the Signup RPC, but since we created this user by ourselves in the terminal, we'll just do it by hand."),Object(a.b)("p",null,"Start by going to the ",Object(a.b)("strong",{parentName:"p"},"Terminal")," and run the following ",Object(a.b)("inlineCode",{parentName:"p"},"update")," statement."),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-python"}),'def main():\n    return update("user", {\n        "where": {"email": "user@example.com"},\n        "data": {"role": {"connect": {"name":"user"}}}\n        })\n')),Object(a.b)("p",null,"Restart Aft as before, but this time with access controls enabled."),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"aft -db ./tutorial.dbl -authed=true -serve_dir=client\n")),Object(a.b)("p",null,"If you open up Aft, you'll notice that no data is displayed, since we don't have access rights to read the schema or other Aft resources. But test out the Todo app, and you should see that everything works!"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Congrats on building your first app with Aft!")),Object(a.b)("p",null,"In the last section, we'll review what we've gone over in this tutorial."))}u.isMDXComponent=!0},95:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var r=n(0),o=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=o.a.createContext({}),u=function(e){var t=o.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return o.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},d=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),p=u(n),d=r,h=p["".concat(c,".").concat(d)]||p[d]||b[d]||a;return n?o.a.createElement(h,s(s({ref:t},l),{},{components:n})):o.a.createElement(h,s({ref:t},l))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,c=new Array(a);c[0]=d;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:r,c[1]=s;for(var l=2;l<a;l++)c[l]=n[l];return o.a.createElement.apply(null,c)}return o.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);